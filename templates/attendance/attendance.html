{% extends 'base.html' %}

{% block title %}
  –ü–æ—Å–µ—â–µ–Ω–∏—è | –ê–∫–∞–¥–µ–º–∏—è –î–∂–∏—É-–î–∂–∏—Ç—Å—É
{% endblock %}

{% block extra_css %}
  <style>
    .attendance-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    .attendance-card {
      background: var(--input-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 1rem;
    }
    
    .attendance-date {
      color: var(--accent);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .attendance-status {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
      font-weight: 600;
    }
    
    .status-present {
      background-color: rgba(0, 255, 0, 0.2);
      color: #00ff00;
    }
    
    .status-absent {
      background-color: rgba(255, 0, 0, 0.2);
      color: #ff0000;
    }
    
    .status-late {
      background-color: rgba(255, 165, 0, 0.2);
      color: #ffa500;
    }
  </style>
{% endblock %}

{% block content %}
  <div class="attendance-container">
    <h1>üìä –ü–æ—Å–µ—â–µ–Ω–∏—è</h1>

    {% if report %}
      <div class="card">
        <h2>–û—Ç—á–µ—Ç –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º</h2>
        <p>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—â–µ–Ω–∏–π: {{ attendances.count }}</p>
      </div>
    {% endif %}

    {% if attendances %}
      {% for attendance in attendances %}
        <div class="attendance-card">
          <div class="attendance-date">{{ attendance.date|date:'d.m.Y' }}</div>
          <span class="attendance-status {% if attendance.is_present %}
              status-present
            {% else %}
              status-absent
            {% endif %}">
            {% if attendance.is_present %}
              –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
            {% else %}
              –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
            {% endif %}
          </span>
          <div>
            <b>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:</b> {{ attendance.training.title }}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="card">
        <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö</p>
      </div>
    {% endif %}

    {% if not report %}
      {% if trainings %}
        <form method="post" action="{% url 'attendance:mark' %}">
          {% csrf_token %}
          <label for="training">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É:</label>
          <select name="training" id="training" required>
            {% for training in trainings %}
              <option value="{{ training.id }}">{{ training.title }}</option>
            {% endfor %}
          </select>
          <button type="submit" class="btn">–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ—Å–µ—â–µ–Ω–∏–µ</button>
        </form>
      {% else %}
        <form method="post" action="{% url 'attendance:mark' %}">
          {% csrf_token %}
          <button type="submit" class="btn">–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ—Å–µ—â–µ–Ω–∏–µ</button>
        </form>
      {% endif %}
    {% endif %}
  </div>
{% endblock %}
