{% extends 'base.html' %}

{% block title %}
  –ü–æ—Å–µ—â–µ–Ω–∏—è | –ê–∫–∞–¥–µ–º–∏—è –î–∂–∏—É-–î–∂–∏—Ç—Å—É
{% endblock %}

{% block extra_css %}

  <style>
    .attendance-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    .attendance-card {
      background: var(--input-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 1rem;
    }
    
    .attendance-date {
      color: var(--accent);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .attendance-status {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
      font-weight: 600;
    }
    
    .status-present {
      background-color: rgba(0, 255, 0, 0.2);
      color: #00ff00;
    }
    
    .status-absent {
      background-color: rgba(255, 0, 0, 0.2);
      color: #ff0000;
    }
    
    .status-late {
      background-color: rgba(255, 165, 0, 0.2);
      color: #ffa500;
    }
   nav {
          width: 100%;
          border-left: none;
          border-top: 1px solid var(--border);
          flex-direction: row;
          justify-content: space-around;
          padding: 0.5rem 0;
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          box-shadow: 0 -2px 10px rgba(255, 0, 0, 0.3);
          background-color: #111;
          z-index: 1000;
        }

        nav a {
          margin-bottom: 0;
          padding: 10px;
          font-size: 0.9rem;
          flex-grow: 1;
          text-align: center;
          border-radius: 0;
        }

  </style>
{% endblock %}

{% block content %}
  <div class="attendance-container">
    {% if is_coach %}
      <h1>–ü–æ—Å–µ—â–µ–Ω–∏—è —É—á–µ–Ω–∏–∫–æ–≤</h1>
    {% else %}
      <h1>–ü–æ—Å–µ—â–µ–Ω–∏—è</h1>
    {% endif %}

    {% if not is_coach %}
      {% if streak > 1 %}

        {% if streak < 5 %}
          <h3>üî•{{ streak }} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ–¥—Ä—è–¥! –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!üî•</h3>
        {% else %}
          <h3>üî•{{ streak }} —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –ø–æ–¥—Ä—è–¥! –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!üî•</h3>
        {% endif %}
      {% endif %}
    {% endif %}

    {% if report %}
      <div class="card">
        <h2>–û—Ç—á–µ—Ç –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º</h2>
        <p>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—â–µ–Ω–∏–π: {{ attendances.count }}</p>
      </div>
    {% endif %}

    {% if attendances %}
      {% for attendance in attendances %}
        <div class="attendance-card">
          {% if is_coach %}
            <div>
             <b>{{ attendance.student.first_name }} {{ attendance.student.last_name }}</b>
            </div>
          {% endif %}
          <div class="attendance-date">{{ attendance.date|date:'d.m.Y' }}</div>
          <span class="attendance-status {% if attendance.is_present %}
              status-present
            {% else %}
              status-absent
            {% endif %}">
            {% if attendance.is_present %}
              –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
            {% else %}
              –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª
            {% endif %}
          </span>
          <div>
            <b>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:</b> {{ attendance.training.title }}
          </div>
        </div>

      {% endfor %}
    {% else %}
      <div class="card">
        <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ—Å–µ—â–µ–Ω–∏—è—Ö</p>
      </div>
    {% endif %}

    {% if not report %}
      {% if is_coach %}
        <form method="post" action="{% url 'attendance:mark' %}">
          {% csrf_token %}
          <label for="training">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É:</label>
          <select name="training" id="training" required>
            {% for training in trainings %}
              <option value="{{ training.id }}">{{ training.title }}</option>
            {% endfor %}
          </select>
          <label for="student">–í—ã–±–µ—Ä–∏—Ç–µ —É—á–µ–Ω–∏–∫–∞:</label>
          <select name="studen" id="student" required>
            {% for student in students %}
              <option value="{{ student.id }}">{{ student.first_name }} {{ student.last_name }}</option>
            {% endfor %}
          </select>
          <p> </p>
          <button type="submit" class="btn">–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ—Å–µ—â–µ–Ω–∏–µ</button>
        </form>
      {% endif %}
    {% endif %}
  </div>

  <nav>
      <a href="{% url 'dashboard:home' %}">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="{% url 'tournaments:list' %}">–¢—É—Ä–Ω–∏—Ä—ã</a>
      <a href="{% url 'store:list' %}">–ú–∞–≥–∞–∑–∏–Ω</a>
    <a href="{% url 'announcements:list' %}">–ù–æ–≤–æ—Å—Ç–∏</a>
      <a href="{% url 'gyms:list' %}">–ê–∫–∞–¥–µ–º–∏—è</a>
      <a href="{% url 'attendance:list' %}" class="active">–ü–æ—Å–µ—â–µ–Ω–∏—è</a>
      <a href="{% url 'users:profile' %}">–ü—Ä–æ—Ñ–∏–ª—å</a>

    </nav>
{% endblock %}
